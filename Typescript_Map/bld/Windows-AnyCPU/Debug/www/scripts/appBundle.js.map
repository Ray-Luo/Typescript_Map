{"version":3,"file":"appBundle.js","sourceRoot":"","sources":["../../scripts/map.ts","../../scripts/index.ts"],"names":[],"mappings":"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","sourcesContent":["﻿/// <reference path=\"jquery.d.ts\"/>\r\n/// <reference path=\"pouch.d.ts\"/>\r\n/// <reference path=\"typings/leaflet-draw/leaflet-draw.d.ts\"/>\r\n\r\nmodule Map\r\n{\r\n    \"use strict\";\r\n\r\n\r\n\r\n    export class Map\r\n    {\r\n\r\n        public static mymap;\r\n        public static _this;\r\n        private form: JQuery = $(\"#form\");\r\n        private submitButton: JQuery = $(\"#submit\");\r\n        public static db;\r\n        public static point_flag = 0;\r\n        public static line_flag = 1;\r\n        public static cursor_x;\r\n        public static cursor_y;\r\n        public static pt_list = [];\r\n        public static temp_polyline;\r\n        public static drawnItems;\r\n        public static html_window = window;\r\n\r\n\r\n\r\n        constructor(form: HTMLFormElement) {\r\n            Map._this = this;\r\n\r\n            var button = document.querySelector('#submit');\r\n            \r\n            this.initialize_map();\r\n\r\n            this.setup_puuchDB();\r\n\r\n            button.addEventListener('click', function (e) {\r\n                Map._this.addFeature(Number($(\"#point1_x\").val()), Number($(\"#point1_y\").val()), Number($(\"#point2_x\").val()), Number($(\"#point2_y\").val()));                \r\n                e.preventDefault();\r\n            });\r\n        }\r\n                \r\n        addFeature = (x1: number, y1: number, x2: number, y2: number): void => {\r\n            if (x2 != 0 && y2 != 0) {\r\n                Map._this.addline(x1, y1, x2, y2);\r\n            } else\r\n            Map._this.addPoint(x1, y1);\r\n        }\r\n\r\n        addPoint = (x: number, y: number): void => {\r\n            L.marker([x, y]).addTo(Map.mymap);\r\n        }\r\n\r\n        addline = (x1: number, y1: number, x2: number, y2: number): void => {\r\n            var pointA = new L.LatLng(x1, y1);\r\n            var pointB = new L.LatLng(x2, y2);\r\n            var pointList = [pointA, pointB];\r\n\r\n            var firstpolyline = new L.Polyline(pointList).addTo(Map.mymap);\r\n            Map.mymap.setView([(x1 + x2) / 2, (y1 + y2) / 2]);\r\n        }\r\n\r\n        initialize_map():void\r\n        {\r\n            $(\"h1\").css(\"font-size\", \"36px\");\r\n\r\n            \r\n           \r\n            Map.mymap = new L.Map('mapid', { editable:true}).setView([36,-96], 13);\r\n\r\n            \r\n\r\n            L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {\r\n                maxZoom: 18,\r\n                attribution: 'Map data &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors, ' +\r\n                '<a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, ' +\r\n                'Imagery © <a href=\"http://mapbox.com\">Mapbox</a>',\r\n                id: 'mapbox.streets'\r\n            }).addTo(Map.mymap);\r\n     \r\n            L.circle([39.19, -96.5], 500, {\r\n                color: 'red',\r\n                fillColor: '#f03',\r\n                fillOpacity: 0.5\r\n            }).addTo(Map.mymap).bindPopup(\"I am a circle.\");\r\n\r\n            L.polygon([\r\n                [39.18, -96.5],\r\n                [39.19, -96.6],\r\n                [39.17, -96.55]\r\n            ]).addTo(Map.mymap).bindPopup(\"I am a polygon.\");\r\n\r\n\r\n\r\n\r\n\r\n            Map.drawnItems = new L.FeatureGroup();\r\n            Map.mymap.addLayer(Map.drawnItems);\r\n                    \r\n            var drawControl = new L.Control.Draw({\r\n                edit: {\r\n                    featureGroup: Map.drawnItems\r\n                }\r\n            });\r\n            \r\n            Map.mymap.addControl(drawControl);  \r\n\r\n           \r\n            //  Fired when start editting\r\n            Map.mymap.on('draw:created', function (e) {\r\n                var title,\r\n                    type = e.layerType,\r\n                    layer = e.layer,\r\n                    layerJSON,\r\n                    newFeature;\r\n\r\n\r\n                navigator.notification.prompt(\r\n                    'Please give a title',  // message\r\n                    saveFeatureToDB,        // callback to invoke\r\n                    'New Task',            // title\r\n                    ['Ok', 'Exit'],             // buttonLabels\r\n                    'Inspection #1'                 // defaultText\r\n                );\r\n\r\n                function saveFeatureToDB(results):void\r\n                {\r\n                    title = results.input1;\r\n                    layer.title = title,\r\n                    layerJSON = layer.toGeoJSON(),\r\n                    newFeature = {\r\n                            _id: title,\r\n                            jsonString: JSON.stringify(layerJSON)\r\n                        };\r\n\r\n                    //  save in db\r\n                    Map.db.put(newFeature).then(function () {\r\n                    }).catch(function (err) {\r\n                        if (err.name === 'conflict') {\r\n                            window.alert(\"This title has already been used please give it another title\");\r\n                        } else {\r\n                            // some other error\r\n                        }\r\n                    });\r\n                }\r\n\r\n                \r\n\r\n                //  add layer to map\r\n                Map.drawnItems.addLayer(layer); \r\n                Map.mymap.addLayer(layer);\r\n            });\r\n\r\n\r\n            //  Fired when finished editting\r\n            Map.mymap.on('draw:edited', function (e) {\r\n                var shape;\r\n                var layers = e.layers;\r\n\r\n                layers.eachLayer(function (layer) {\r\n                    //do whatever you want, most likely save back to db\r\n                    var layerJSON = layer.toGeoJSON();\r\n\r\n                    Map.db.get(layer.title).then(function (doc) {\r\n                        return Map.db.put({\r\n                            _id: doc._id,\r\n                            _rev: doc._rev,\r\n                            jsonString: JSON.stringify(layerJSON)\r\n                        });\r\n                    }).then(function (response) {\r\n                        // handle response\r\n                    }).catch(function (err) {\r\n                        console.log(err);\r\n                    });\r\n                });\r\n            });\r\n\r\n\r\n            Map.mymap.on('draw:deleted', function (e) {\r\n                // Update db to save latest changes.\r\n                var i = 1;\r\n            });\r\n\r\n            function onMapClick(e) {\r\n              // var popup = L.popup(); popup.setLatLng(e.latlng).setContent(\"You clicked the map at \" + e.latlng.toString()).openOn(Map.mymap);\r\n/*\r\n                var point = new L.LatLng(Number(e.latlng.lat.toString()), Number(e.latlng.lng.toString()));\r\n\r\n                //  Save them in the db\r\n                Map.db.get('line').then(function (line) {\r\n                    line.path_pt.push(point);\r\n                    return Map.db.put(line);\r\n                }).then(function () {\r\n                    return Map.db.get('line');\r\n                }).then(function (doc) {\r\n                    console.log(doc);\r\n                    });\r\n\r\n                //  Show them\r\n                Map.pt_list.push(point);\r\n                if (Map.temp_polyline != null)\r\n                    Map.mymap.removeLayer(Map.temp_polyline);\r\n                Map.temp_polyline = new L.Polyline(Map.pt_list).addTo(Map.mymap);\r\n*/\r\n            }\r\n\r\n            Map.mymap.on('click', onMapClick);\r\n        }\r\n\r\n        setup_puuchDB(): void\r\n        {                      \r\n            Map.db = new PouchDB(\"LeveeInspection_1\");\r\n\r\n            {\r\n            /*\r\n            Map.db.destroy().then(function (response) {\r\n                // success\r\n            }).catch(function (err) {\r\n                console.log(err);\r\n            });   \r\n \r\n            Map.db.allDocs({ include_docs: true, descending: true }, function (err, result) {\r\n                var features = result.rows;\r\n\r\n                for (var i = 0; i < features.length; i++) {\r\n                    //  if it is a point\r\n                    Map.db.get(features[i].doc._id).then(function (doc) {\r\n                        return Map.db.remove(doc);\r\n                    });\r\n                    \r\n                }\r\n            });\r\n\r\n*/ }\r\n\r\n            Map.db.allDocs({ include_docs: true, descending: true }, function (err, result) {\r\n                var features = result.rows;\r\n\r\n                for (var i = 0; i < features.length; i++)\r\n                {\r\n                    var json = JSON.parse(features[i].doc.jsonString);\r\n                    var geoJSON = L.geoJson(json);\r\n                    var newLayer = geoJSON.getLayers()[0];\r\n                    Map.drawnItems.addLayer(newLayer);\r\n                }\r\n            });\r\n            /*\r\n            db.changes({\r\n                since: 'now',\r\n                live: true\r\n            }).on('change', showTodos);   */\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    \r\n\r\n}","﻿// For an introduction to the Blank template, see the following documentation:\n// http://go.microsoft.com/fwlink/?LinkID=397705\n// To debug code on page load in Ripple or on Android devices/emulators: launch your app, set breakpoints, \n// and then run \"window.location.reload()\" in the JavaScript Console.\n\n/// <reference path=\"jquery.d.ts\"/>\n/// <reference path=\"map.ts\"/>\n\n\nmodule TypescriptMap {\n    \"use strict\";\n\n    export module Application {\n        export function initialize() {\n            document.addEventListener('deviceready', onDeviceReady, false);\n        }\n\n        function onDeviceReady() {\n            // Handle the Cordova pause and resume events\n            document.addEventListener('pause', onPause, false);\n            document.addEventListener('resume', onResume, false);\n\n            // TODO: Cordova has been loaded. Perform any initialization that requires Cordova here.\n            var parentElement = document.getElementById('deviceready');\n            var listeningElement = parentElement.querySelector('.listening');\n            var receivedElement = parentElement.querySelector('.received');\n            listeningElement.setAttribute('style', 'display:none;');\n            receivedElement.setAttribute('style', 'display:block;');\n\n\n            var map: Map.Map = new Map.Map(<HTMLFormElement>document.getElementById('form'));\n\n        }\n\n        function onPause() {\n            // TODO: This application has been suspended. Save application state here.\n        }\n\n        function onResume() {\n            // TODO: This application has been reactivated. Restore application state here.\n        }\n\n    }\n\n    window.onload = function () {\n        Application.initialize();\n    }\n}\n"]}