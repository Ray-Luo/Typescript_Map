{"version":3,"file":"appBundle.js","sourceRoot":"","sources":["../../scripts/map.ts","../../scripts/index.ts"],"names":[],"mappings":"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","sourcesContent":["﻿/// <reference path=\"jquery.d.ts\"/>\r\n/// <reference path=\"pouch.d.ts\"/>\r\n/// <reference path=\"typings/leaflet-draw/leaflet-draw.d.ts\"/>\r\n\r\nmodule Map\r\n{\r\n    \"use strict\";\r\n\r\n\r\n\r\n    export class Map\r\n    {\r\n\r\n        public static mymap;\r\n        public static _this;\r\n        private form: JQuery = $(\"#form\");\r\n        private submitButton: JQuery = $(\"#submit\");\r\n        public static db;\r\n        public static point_flag = 0;\r\n        public static line_flag = 1;\r\n        public static cursor_x;\r\n        public static cursor_y;\r\n      //  public static length;\r\n        public static pt_list = [];\r\n        public static temp_polyline;\r\n       \r\n\r\n\r\n\r\n        constructor(form: HTMLFormElement) {\r\n            Map._this = this;\r\n\r\n            var button = document.querySelector('#submit');\r\n            \r\n            this.initialize_map();\r\n\r\n            this.setup_puuchDB();\r\n\r\n            button.addEventListener('click', function (e) {\r\n                Map._this.addFeature(Number($(\"#point1_x\").val()), Number($(\"#point1_y\").val()), Number($(\"#point2_x\").val()), Number($(\"#point2_y\").val()));                \r\n                e.preventDefault();\r\n            });\r\n        }\r\n                \r\n        addFeature = (x1: number, y1: number, x2: number, y2: number): void => {\r\n            if (x2 != 0 && y2 != 0) {\r\n                Map._this.addline(x1, y1, x2, y2);\r\n            } else\r\n            Map._this.addPoint(x1, y1);\r\n        }\r\n\r\n        addPoint = (x: number, y: number): void => {\r\n            L.marker([x, y]).addTo(Map.mymap);\r\n        }\r\n\r\n        addline = (x1: number, y1: number, x2: number, y2: number): void => {\r\n            var pointA = new L.LatLng(x1, y1);\r\n            var pointB = new L.LatLng(x2, y2);\r\n            var pointList = [pointA, pointB];\r\n\r\n            var firstpolyline = new L.Polyline(pointList).addTo(Map.mymap);\r\n            Map.mymap.setView([(x1 + x2) / 2, (y1 + y2) / 2]);\r\n        }\r\n\r\n        initialize_map():void\r\n        {\r\n            $(\"h1\").css(\"font-size\", \"36px\");\r\n\r\n            \r\n\r\n            Map.mymap = new L.Map('mapid', { editable:true}).setView([36,-96], 13);\r\n\r\n            \r\n\r\n            L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpandmbXliNDBjZWd2M2x6bDk3c2ZtOTkifQ._QA7i5Mpkd_m30IGElHziw', {\r\n                maxZoom: 18,\r\n                attribution: 'Map data &copy; <a href=\"http://openstreetmap.org\">OpenStreetMap</a> contributors, ' +\r\n                '<a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, ' +\r\n                'Imagery © <a href=\"http://mapbox.com\">Mapbox</a>',\r\n                id: 'mapbox.streets'\r\n            }).addTo(Map.mymap);\r\n     \r\n            L.circle([39.19, -96.5], 500, {\r\n                color: 'red',\r\n                fillColor: '#f03',\r\n                fillOpacity: 0.5\r\n            }).addTo(Map.mymap).bindPopup(\"I am a circle.\");\r\n\r\n            L.polygon([\r\n                [39.18, -96.5],\r\n                [39.19, -96.6],\r\n                [39.17, -96.55]\r\n            ]).addTo(Map.mymap).bindPopup(\"I am a polygon.\");\r\n\r\n            var drawnItems = new L.FeatureGroup();\r\n            Map.mymap.addLayer(drawnItems);\r\n                    \r\n            var drawControl = new L.Control.Draw({\r\n                edit: {\r\n                    featureGroup: drawnItems\r\n                }\r\n            });\r\n            \r\n            Map.mymap.addControl(drawControl);  \r\n\r\n            Map.mymap.on('draw:created', function (e) {\r\n                var type = e.layerType,\r\n                    layer = e.layer;\r\n                \r\n                if (type === 'marker') {\r\n                    // Do marker specific actions\r\n                    //var point: L.Marker = new L.Marker([]);\r\n                   // point = <L.Marker>layer;\r\n                    //point.editing.enable();\r\n                }\r\n\r\n                var polygon = new L.Polygon([\r\n                    [51.51, -0.1],\r\n                    [51.5, -0.06],\r\n                    [51.52, -0.03]\r\n                ]);\r\n                polygon.enableEdit();\r\n\r\n                // Do whatever else you need to. (save to db, add to map etc)\r\n                Map.mymap.addLayer(layer);\r\n            });\r\n\r\n            Map.mymap.on('draw:edited', function (e) {\r\n                var type = e.layerType,\r\n                    layer = e.layer;\r\n\r\n                if (type === 'marker') {\r\n                    // Do marker specific actions\r\n                }\r\n\r\n                // Do whatever else you need to. (save to db, add to map etc)\r\n                Map.mymap.addLayer(layer);\r\n            });\r\n\r\n\r\n            function onMapClick(e) {\r\n              // var popup = L.popup(); popup.setLatLng(e.latlng).setContent(\"You clicked the map at \" + e.latlng.toString()).openOn(Map.mymap);\r\n/*\r\n                var point = new L.LatLng(Number(e.latlng.lat.toString()), Number(e.latlng.lng.toString()));\r\n\r\n                //  Save them in the db\r\n                Map.db.get('line').then(function (line) {\r\n                    line.path_pt.push(point);\r\n                    return Map.db.put(line);\r\n                }).then(function () {\r\n                    return Map.db.get('line');\r\n                }).then(function (doc) {\r\n                    console.log(doc);\r\n                    });\r\n\r\n                //  Show them\r\n                Map.pt_list.push(point);\r\n                if (Map.temp_polyline != null)\r\n                    Map.mymap.removeLayer(Map.temp_polyline);\r\n                Map.temp_polyline = new L.Polyline(Map.pt_list).addTo(Map.mymap);\r\n*/\r\n            }\r\n\r\n            Map.mymap.on('click', onMapClick);\r\n        }\r\n\r\n        setup_puuchDB(): void\r\n        {                      \r\n            Map.db = new PouchDB(\"LeveeInspection_1\");\r\n\r\n            {\r\n             /*\r\n            Map.db.destroy().then(function (response) {\r\n                // success\r\n            }).catch(function (err) {\r\n                console.log(err);\r\n            });   \r\n\r\n            Map.db.allDocs({ include_docs: true, descending: true }, function (err, result) {\r\n                var features = result.rows;\r\n\r\n                for (var i = 0; i < features.length; i++) {\r\n                    //  if it is a point\r\n                    Map.db.get(features[i].doc._id).then(function (doc) {\r\n                        return Map.db.remove(doc);\r\n                    });\r\n                    \r\n                }\r\n            });\r\n\r\n            var base_pt_start = new L.LatLng(36, -96);\r\n            var base_pt_end = new L.LatLng(36.1, -96.1);\r\n\r\n            var line = {\r\n                _id: \"line\",\r\n                flag: Map.line_flag,\r\n                base_pt: [base_pt_start, base_pt_end],\r\n                path_pt: []\r\n            }\r\n\r\n            Map.db.bulkDocs([line]);*/ }\r\n\r\n            Map.db.allDocs({ include_docs: true, descending: true }, function (err, result) {\r\n                var features = result.rows;\r\n                /*\r\n                Map.pt_list.push(features[0].doc.base_pt[1]);\r\n\r\n                var path_pt_length = features[0].doc.path_pt.length;\r\n                if (path_pt_length != 0)\r\n                    for (var i = 0; i < path_pt_length; i++)\r\n                        Map.pt_list.push(features[0].doc.path_pt[i]);\r\n                Map.pt_list.push(features[0].doc.base_pt[0]);\r\n                Map.pt_list.push(features[0].doc.base_pt[1]);\r\n                Map.temp_polyline = new L.Polyline(Map.pt_list).addTo(Map.mymap);\r\n\r\n\r\n                Map.db.allDocs({ include_docs: true, descending: true }, function (err, result) {\r\n                    var features = result.rows;\r\n                });                \r\n                */\r\n            });\r\n\r\n\r\n            \r\n            /*\r\n            db.changes({\r\n                since: 'now',\r\n                live: true\r\n            }).on('change', showTodos);   */\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    \r\n\r\n}","﻿// For an introduction to the Blank template, see the following documentation:\n// http://go.microsoft.com/fwlink/?LinkID=397705\n// To debug code on page load in Ripple or on Android devices/emulators: launch your app, set breakpoints, \n// and then run \"window.location.reload()\" in the JavaScript Console.\n\n/// <reference path=\"jquery.d.ts\"/>\n/// <reference path=\"map.ts\"/>\n//import Map = require('Map');\n\nmodule TypescriptMap {\n    \"use strict\";\n\n    export module Application {\n        export function initialize() {\n            document.addEventListener('deviceready', onDeviceReady, false);\n        }\n\n        function onDeviceReady() {\n            // Handle the Cordova pause and resume events\n            document.addEventListener('pause', onPause, false);\n            document.addEventListener('resume', onResume, false);\n\n            // TODO: Cordova has been loaded. Perform any initialization that requires Cordova here.\n            var parentElement = document.getElementById('deviceready');\n            var listeningElement = parentElement.querySelector('.listening');\n            var receivedElement = parentElement.querySelector('.received');\n            listeningElement.setAttribute('style', 'display:none;');\n            receivedElement.setAttribute('style', 'display:block;');\n\n\n            var map: Map.Map = new Map.Map(<HTMLFormElement>document.getElementById('form'));\n\n        }\n\n        function onPause() {\n            // TODO: This application has been suspended. Save application state here.\n        }\n\n        function onResume() {\n            // TODO: This application has been reactivated. Restore application state here.\n        }\n\n    }\n\n    window.onload = function () {\n        Application.initialize();\n    }\n}\n"]}